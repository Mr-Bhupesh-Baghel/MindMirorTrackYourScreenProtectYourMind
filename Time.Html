<!DOCTYPE html><html lang="en"><head>
  <meta charset="utf-8">
  <title>Time Summary</title>
  <style>
    body{font-family:Arial, sans-serif; margin:30px; color:#333;}
    h1{margin-bottom:10px;}
    .meta{margin:8px 0 20px; color:#666;}
    table{border-collapse:collapse; width:520px; max-width:100%;}
    th,td{border:1px solid #ddd; padding:10px; text-align:center;}
    th{background:#f5f5f5;}
    tfoot td{font-weight:bold; background:#fafafa;}
    .actions{margin:16px 0;}
    button{padding:8px 14px; border:none; border-radius:6px; cursor:pointer; background:#1976d2; color:#fff;}
    button:hover{background:#145fa8;}
    .danger{background:#e53935;} .danger:hover{background:#c62828;}
  </style>
</head><body>
  <h1>Page Time Summary</h1>
  <div class="meta">Shows total time spent on each page (HH:MM:SS).</div>

  <div class="actions">
    <button id="refresh">Refresh</button>
    <button id="clear" class="danger">Clear All</button>
  </div>

  <table>
    <thead>
      <tr><th>Page</th><th>Time</th></tr>
    </thead>
    <tbody id="summaryBody"><tr><td colspan="2">Loadingâ€¦</td></tr></tbody>
    <tfoot>
      <tr><td>Total</td><td id="total">00:00:00</td></tr>
    </tfoot>
  </table>
  <script>
    (function(){
      const KEY = (window.__MM__ && window.__MM__.KEY) || "pageTimes_v2";
      const fmt = (sec)=> {
        const h = Math.floor(sec/3600), m = Math.floor((sec%3600)/60), s = sec%60;
        return [h,m,s].map(v=>String(v).padStart(2,"0")).join(":");
      };

      function load(){
        try { return JSON.parse(localStorage.getItem(KEY)) || {}; }
        catch { return {}; }
      }

      function render(){
        const data = load();
        const body = document.getElementById("summaryBody");
        const entries = Object.entries(data);
        if (entries.length === 0) {
          body.innerHTML = `<tr><td colspan="2">No data yet. Visit pages first.</td></tr>`;
          document.getElementById("total").textContent = "00:00:00";
          return;
        }
        entries.sort((a,b)=> b[1]-a[1]); // most time first
        body.innerHTML = entries.map(([page,sec]) =>
          `<tr><td>${page}</td><td>${fmt(sec)}</td></tr>`
        ).join("");

        const total = entries.reduce((sum, [,sec]) => sum + sec, 0);
        document.getElementById("total").textContent = fmt(total);
      }

      document.getElementById("refresh").addEventListener("click", render);
      document.getElementById("clear").addEventListener("click", ()=>{
        if (confirm("Clear all tracked times?")) {
          localStorage.removeItem(KEY);
          render();
        }
      });

      render();
    })();
  </script>
</body></html>
